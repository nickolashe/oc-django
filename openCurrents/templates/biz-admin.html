{% extends 'layouts/admin.html' %}

{% load staticfiles %}
{% load macros %}

{% block content %}
  <p class="no-margin-bottom">
    <a href="{% url 'openCurrents:offer' %}" class="button round tiny">
      Post an offer
    </a>
  </p>

  {% block lists %}
    <div class="left row one-margin-top full-width collapse">
      <div class="small-11 medium-10 small-centered columns">
        <h6 class="half-margin-bottom">Our offers</h6>

        {% if offers %}
          {% for offer in offers %}
            <div class="row half-margin-top">
              <div class="left small-9 columns">
                <!-- <p>Fast Folks Bike Shop & Cafe accepts Currents for <strong>50% of flat fixes</strong> <span class="small-text grey">Limit 50 transactions per month</span></p> -->
                <p>
                  {{ orgname }} accepts Currents for

                  <strong>
                    {{offer.currents_share}}% of {{offer.item.name}}
                  </strong>

                  {% if offer.limit != -1 %}
                    <span class="small-text grey">
                      Limit {{ offer.limit }} transactions per month
                    </span>
                  {% endif %}
                </p>
              </div>

              <div class="right relative small-3 columns">
                <a class="mini-open">
                  <i class="blue half-margin-right fa-chevron-circle-down fa fa-lg"></i>
                </a>
                <ul class="mini-menu">
                  <a href="{% url 'openCurrents:edit-offer' offer.id %}">
                    <li> Edit offer </li>
                  </a>
                  <a class="delete-offer-popup_open">
                    <li class="alert"> Delete offer </li>
                  </a>
                </ul>
              </div>
            </div>
          {% endfor %}
        {% else %}
          <div class="row">
            <div class="left small-12 columns">
              <p>{{ orgname }} has not made any offers. <a href="{% url 'openCurrents:offer' %}">Create one!</a></p>
            </div>
          </div>
        {% endif %}
      </div>
    </div>
    
    {% macro redemption_list_macro arg_list arg_status arg_timezone %}
      {% block redemption_list %}
        {% with redemptions=arg_list redemption_status=arg_status timezone=arg_timezone %}
          {{ block.super }}
        {% endwith %}
      {% endblock %}
    {% endmacro %}

    {% usemacro redemption_list_macro redeemed_pending 'Pending' org_timezone %}

    {% usemacro redemption_list_macro redeemed_approved 'Approved' org_timezone %}

  {% endblock lists %}
{% endblock content %}
